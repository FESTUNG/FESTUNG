pAvail = 0 : 2;
iAvail = 1 : 6;

err = cell(size(pAvail)); 
conv = cell(size(pAvail));
for p = pAvail
  for i = iAvail
    pd = main('sweVert', struct('numElem', 2^(i-1) * [2, 1], 'p', p)); 
    err{p+1}(i,:) = pd.error; 
    conv{p+1} = [zeros(1,3); log(err{p+1}(1:end-1,:) ./ err{p+1}(2:end,:)) / log(2)];
    disp(conv{p+1}); 
  end % for i
end % for p

fprintf('Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)\n'); 
for p = 0 : 2
  fprintf('------------------------- p = %d ----------------------\n', p); 
  for i = 1:6
    fprintf('%6.2e  %6.3f   %6.2e  %6.3f   %6.2e  %6.3f\n', err{p+1}(i,1), conv{p+1}(i,1), err{p+1}(i,2), conv{p+1}(i,2), err{p+1}(i,3), conv{p+1}(i,3))
  end % for i
end % for p



% % Testcase convergence
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 7.09e-01   0.000   3.62e-01   0.000   2.41e-01   0.000
% 3.55e-01   1.000   2.42e-01   0.580   1.45e-01   0.738
% 1.77e-01   1.000   1.54e-01   0.654   1.31e-01   0.142
% 8.87e-02   1.000   1.18e-01   0.385   1.26e-01   0.051
% 4.43e-02   1.000   1.22e-01  -0.054   1.04e-01   0.285
% 2.22e-02   1.000   1.33e-01  -0.123   7.91e-02   0.392
% ------------------------- p = 1 ----------------------
% 4.77e-04   0.000   1.15e-02   0.000   2.55e-03   0.000
% 1.21e-04   1.977   2.51e-03   2.196   1.30e-03   0.968
% 3.06e-05   1.986   9.28e-04   1.437   5.86e-04   1.153
% 7.82e-06   1.966   3.16e-04   1.554   4.12e-04   0.510
% 2.13e-06   1.877   8.95e-05   1.819   3.86e-04   0.094
% 7.19e-07   1.566   2.39e-05   1.907   4.26e-04  -0.142
% ------------------------- p = 2 ----------------------
% 3.37e-05   0.000   3.23e-04   0.000   7.03e-05   0.000
% 4.21e-06   3.001   4.52e-05   2.836   1.47e-05   2.256
% 5.90e-07   2.836   8.28e-06   2.450   4.97e-06   1.567
% 2.79e-07   1.079   1.42e-06   2.542   1.65e-06   1.586
% 2.81e-07  -0.011   2.64e-07   2.431   6.38e-07   1.375
% 3.00e-07  -0.094   2.42e-07   0.122   1.39e-06  -1.130

% % Testcase h = 1, u = sin(z), w = 0
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 3.95e-05   0.000   2.51e+00   0.000   1.08e-03   0.000
% 1.36e-05   1.532   1.24e+00   1.021   2.90e-04   1.897
% 4.80e-06   1.508   6.18e-01   1.003   2.61e-04   0.151
% 1.69e-06   1.502   3.13e-01   0.982   2.66e-04  -0.028
% 5.99e-07   1.500   1.72e-01   0.863   2.69e-04  -0.014
% 2.12e-07   1.500   1.33e-01   0.373   2.70e-04  -0.004
% ------------------------- p = 1 ----------------------
% 4.40e-07   0.000   1.77e-01   0.000   3.29e-04   0.000
% 3.79e-08   3.535   5.03e-02   1.812   2.11e-04   0.642
% 3.33e-09   3.509   1.63e-02   1.624   8.25e-05   1.356
% 2.94e-10   3.502   6.65e-03   1.296   3.01e-05   1.452
% 2.60e-11   3.501   3.12e-03   1.090   1.08e-05   1.482
% 2.30e-12   3.500   1.54e-03   1.020   3.84e-06   1.492
% ------------------------- p = 2 ----------------------
% 1.42e-09   0.000   3.14e-02   0.000   1.42e-04   0.000
% 3.05e-11   5.537   5.19e-03   2.598   2.43e-05   2.550
% 6.69e-13   5.509   1.25e-03   2.048   5.47e-06   2.151
% 1.46e-14   5.518   3.86e-04   1.699   1.28e-06   2.099
% 3.99e-16   5.195   1.29e-04   1.579   3.06e-07   2.060
% 0.00e+00     Inf   4.45e-05   1.537   7.48e-08   2.034

% % Testcase h = 0.01 sin(0.01x) + 2, u = sin(z), w = 0
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 1.24e-02   0.000   4.60e+00   0.000   7.08e-03   0.000
% 6.16e-03   1.006   2.55e+00   0.852   3.78e-03   0.907
% 3.08e-03   1.002   1.29e+00   0.977   2.22e-03   0.765
% 1.54e-03   1.000   6.50e-01   0.994   1.41e-03   0.655
% 7.69e-04   1.000   3.25e-01   0.998   9.41e-04   0.585
% 3.85e-04   1.000   1.63e-01   0.999   6.45e-04   0.544
% ------------------------- p = 1 ----------------------
% 4.77e-04   0.000   1.71e+00   0.000   2.48e-04   0.000
% 1.21e-04   1.977   4.12e-01   2.053   5.73e-05   2.114
% 3.04e-05   1.995   1.03e-01   2.006   1.34e-05   2.097
% 7.60e-06   1.999   2.56e-02   2.001   3.35e-06   1.998
% 1.90e-06   1.999   6.41e-03   2.000   9.09e-07   1.884
% 4.76e-07   1.999   1.60e-03   1.999   2.83e-07   1.681
% ------------------------- p = 2 ----------------------
% 3.37e-05   0.000   1.89e-01   0.000   4.85e-05   0.000
% 4.20e-06   3.004   2.75e-02   2.779   1.27e-05   1.938
% 5.26e-07   2.999   3.52e-03   2.965   3.29e-06   1.944
% 6.75e-08   2.961   4.43e-04   2.990   8.38e-07   1.975
% 1.19e-08   2.510   5.56e-05   2.995   2.11e-07   1.988
% 4.57e-09   1.374   7.03e-06   2.984   5.30e-08   1.994

% % Testcase h = 2, u = sin(omega*x)sin(z), w = omega*cos(omega*x)*cos(z)
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 2.04e-04   0.000   2.71e+00   0.000   1.45e-01   0.000
% 7.72e-05   1.404   1.48e+00   0.868   5.98e-02   1.282
% 2.79e-05   1.466   7.54e-01   0.978   2.82e-02   1.084
% 9.99e-06   1.485   3.78e-01   0.995   1.38e-02   1.035
% 3.55e-06   1.493   1.89e-01   0.999   6.80e-03   1.016
% 1.26e-06   1.496   9.46e-02   1.000   3.39e-03   1.007
% ------------------------- p = 1 ----------------------
% 6.21e-05   0.000   8.88e-01   0.000   1.30e-02   0.000
% 4.14e-05   0.585   2.14e-01   2.056   5.23e-03   1.313
% 2.37e-05   0.804   5.32e-02   2.005   2.02e-03   1.373
% 1.26e-05   0.912   1.33e-02   2.001   9.33e-04   1.115
% 6.49e-06   0.958   3.32e-03   2.000   4.62e-04   1.013
% 3.29e-06   0.980   8.31e-04   2.000   2.32e-04   0.993
% ------------------------- p = 2 ----------------------
% 8.51e-07   0.000   9.83e-02   0.000   3.99e-03   0.000
% 1.15e-07   2.888   1.44e-02   2.773   4.63e-04   3.105
% 1.50e-08   2.938   1.84e-03   2.967   5.72e-05   3.017
% 1.91e-09   2.970   2.31e-04   2.992   7.14e-06   3.002
% 2.42e-10   2.985   2.90e-05   2.997   9.34e-07   2.935
% 3.04e-11   2.993   3.65e-06   2.987   1.83e-07   2.352