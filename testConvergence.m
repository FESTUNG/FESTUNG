pAvail = 0 : 2;
iAvail = 1 : 6;

err = cell(size(pAvail)); 
conv = cell(size(pAvail));
for p = pAvail
  for i = iAvail
    pd = main('sweVert', struct('numElem', 2^(i-1) * [2, 1], 'p', p)); 
    err{p+1}(i,:) = pd.error; 
    conv{p+1} = [zeros(1,3); log(err{p+1}(1:end-1,:) ./ err{p+1}(2:end,:)) / log(2)];
    disp(conv{p+1}); 
  end % for i
end % for p

fprintf('Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)\n'); 
for p = 0 : 2
  fprintf('------------------------- p = %d ----------------------\n', p); 
  for i = 1:6
    fprintf('%6.2e  %6.3f   %6.2e  %6.3f   %6.2e  %6.3f\n', err{p+1}(i,1), conv{p+1}(i,1), err{p+1}(i,2), conv{p+1}(i,2), err{p+1}(i,3), conv{p+1}(i,3))
  end % for i
end % for p



% % Testcase convergence
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 9.91e-04   0.000   2.27e-03   0.000   2.41e-01   0.000
% 6.99e-04   0.502   1.59e-03   0.511   1.45e-01   0.738
% 6.77e-04   0.047   1.31e-03   0.280   1.31e-01   0.144
% 6.21e-04   0.125   1.07e-03   0.296   1.26e-01   0.051
% 4.89e-04   0.344   8.11e-04   0.398   1.04e-01   0.286
% 3.64e-04   0.428   6.60e-04   0.298   7.89e-02   0.394
% ------------------------- p = 1 ----------------------
% 1.69e-05   0.000   5.28e-06   0.000   2.13e-03   0.000
% 8.01e-06   1.079   3.98e-06   0.408   1.07e-03   0.990
% 3.86e-06   1.051   3.52e-06   0.177   5.41e-04   0.988
% 1.90e-06   1.023   2.66e-06   0.405   3.93e-04   0.461
% 9.68e-07   0.975   2.34e-06   0.183   3.33e-04   0.239
% 5.40e-07   0.841   2.91e-06  -0.315   3.44e-04  -0.049
% ------------------------- p = 2 ----------------------
% 9.75e-07   0.000   2.00e-06   0.000   7.01e-05   0.000
% 3.25e-07   1.586   6.79e-07   1.555   1.47e-05   2.253
% 2.70e-07   0.268   2.71e-07   1.325   4.96e-06   1.567
% 2.72e-07  -0.009   1.48e-07   0.875   1.65e-06   1.586
% 2.81e-07  -0.051   1.71e-07  -0.208   6.38e-07   1.375
% 3.00e-07  -0.095   2.41e-07  -0.495   1.39e-06  -1.130

% % Testcase h = 1, u = sin(z), w = 0
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 3.95e-05   0.000   5.40e-02   0.000   1.08e-03   0.000
% 1.36e-05   1.532   3.32e-02   0.703   2.90e-04   1.897
% 4.80e-06   1.508   3.97e-02  -0.258   2.61e-04   0.151
% 1.69e-06   1.502   5.45e-02  -0.457   2.66e-04  -0.028
% 5.99e-07   1.500   7.66e-02  -0.491   2.69e-04  -0.014
% 2.12e-07   1.500   1.08e-01  -0.498   2.70e-04  -0.004
% ------------------------- p = 1 ----------------------
% 4.40e-07   0.000   2.22e-02   0.000   3.29e-04   0.000
% 3.79e-08   3.535   1.95e-02   0.185   2.11e-04   0.642
% 3.33e-09   3.509   1.14e-02   0.779   8.25e-05   1.356
% 2.94e-10   3.502   5.97e-03   0.931   3.01e-05   1.452
% 2.60e-11   3.501   3.04e-03   0.975   1.08e-05   1.482
% 2.30e-12   3.500   1.53e-03   0.990   3.84e-06   1.492
% ------------------------- p = 2 ----------------------
% 1.42e-09   0.000   1.45e-02   0.000   1.42e-04   0.000
% 3.05e-11   5.537   3.89e-03   1.903   2.43e-05   2.550
% 6.69e-13   5.509   1.18e-03   1.721   5.47e-06   2.151
% 1.49e-14   5.491   3.83e-04   1.624   1.28e-06   2.099
% 2.66e-16   5.808   1.29e-04   1.567   3.06e-07   2.060
% 0.00e+00     Inf   4.45e-05   1.536   7.48e-08   2.034

% % Testcase h = 0.01 sin(0.01x) + 2, u = sin(z), w = 0
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 5.13e-04   0.000   5.98e-04   0.000   7.08e-03   0.000
% 1.58e-04   1.699   2.53e-04   1.238   3.78e-03   0.907
% 5.01e-05   1.655   2.41e-04   0.074   2.22e-03   0.765
% 1.47e-05   1.775   3.02e-04  -0.328   1.41e-03   0.655
% 3.26e-06   2.168   4.16e-04  -0.462   9.41e-04   0.585
% 1.05e-06   1.640   5.85e-04  -0.492   6.45e-04   0.544
% ------------------------- p = 1 ----------------------
% 2.51e-05   0.000   4.81e-04   0.000   2.48e-04   0.000
% 2.16e-06   3.542   4.17e-04   0.206   5.73e-05   2.114
% 2.86e-07   2.915   2.41e-04   0.793   1.34e-05   2.097
% 9.56e-08   1.580   1.26e-04   0.935   3.35e-06   1.998
% 4.46e-08   1.100   6.39e-05   0.980   9.09e-07   1.884
% 2.18e-08   1.033   3.26e-05   0.971   2.83e-07   1.681
% ------------------------- p = 2 ----------------------
% 4.27e-07   0.000   2.39e-04   0.000   4.85e-05   0.000
% 8.09e-08   2.398   6.70e-05   1.836   1.27e-05   1.938
% 3.14e-08   1.368   2.33e-05   1.523   3.29e-06   1.944
% 1.61e-08   0.964   8.04e-06   1.537   8.38e-07   1.975
% 8.56e-09   0.909   2.83e-06   1.505   2.11e-07   1.988
% 4.46e-09   0.942   1.03e-06   1.464   5.30e-08   1.994

% % Testcase h = 2, u = sin(omega*x)sin(z), w = omega*cos(omega*x)*cos(z)
% Err(h)     C(h)    Err(u)     C(u)    Err(w)     C(w)
% ------------------------- p = 0 ----------------------
% 2.04e-04   0.000   2.53e-03   0.000   1.46e-01   0.000
% 7.72e-05   1.404   1.75e-03   0.533   5.53e-02   1.397
% 2.79e-05   1.466   1.16e-03   0.595   2.52e-02   1.136
% 9.99e-06   1.485   7.99e-04   0.532   1.21e-02   1.059
% 3.55e-06   1.493   5.90e-04   0.438   5.92e-03   1.028
% 1.26e-06   1.496   4.98e-04   0.244   2.94e-03   1.012
% ------------------------- p = 1 ----------------------
% 6.21e-05   0.000   3.39e-04   0.000   7.07e-03   0.000
% 4.14e-05   0.585   2.87e-04   0.240   4.36e-03   0.698
% 2.37e-05   0.804   1.67e-04   0.781   1.89e-03   1.209
% 1.26e-05   0.912   8.82e-05   0.922   9.15e-04   1.043
% 6.49e-06   0.958   4.51e-05   0.969   4.60e-04   0.992
% 3.29e-06   0.980   2.27e-05   0.987   2.32e-04   0.988
% ------------------------- p = 2 ----------------------
% 8.51e-07   0.000   1.03e-04   0.000   3.35e-03   0.000
% 1.15e-07   2.888   3.65e-05   1.494   3.66e-04   3.192
% 1.50e-08   2.938   1.26e-05   1.539   4.44e-05   3.044
% 1.91e-09   2.970   4.25e-06   1.562   5.51e-06   3.010
% 2.42e-10   2.985   1.45e-06   1.547   7.40e-07   2.896
% 3.04e-11   2.993   5.04e-07   1.528   1.68e-07   2.135